<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link href="//cdn.bootcss.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container">
<!--页面名称-->
<h3>管理员用户管理<a href="tpl/admin/addUserByAdmin.html">新增用户>></a></h3>
<!--列表开始-->
<br/>
<table class="table table-bordered table-hover">
    <thead>
        <tr>
            <th>序号</th>
            <th>用户名</th>
            <th>注册时间</th>
            <th>操作</th>
        </tr>
    </thead>

    {if $retArr['class_list']}
    {foreach from=$retArr['class_list'] item = value}
        {if $value.username == "admin"}
            <tbody>
                <tr>
                    <td>{$value.id}</td>
                    <td>{$value.username}</td>
                    <td>{$value.loginTime}</td>
                    <td><a href="javascript:void(0);">默认管理员不能删除</a></td>
                <tr>
            <tbody>
        {else}
            <tbody>
                <tr>
                    <td>{$value.id}</td>
                    <td>{$value.username}</td>
                    <td>{$value.loginTime}</td>
                    <td><a href="javascript:void(0);" onclick = "isDelete({$value.id})">删除</a></td>
                <tr>
            <tbody>
        {/if}
    {/foreach}
    {else}
        <tr><td colspan=3>无记录</td></tr>
    {/if}
</table>
<ul class="pagination" id="pagination"></ul>
</div>
<script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="http://apps.bdimg.com/libs/bootstrap/3.0.3/js/bootstrap.min.js"></script>
<script type="text/javascript" src="./Static/JS/multi.js?v=20160116"></script>
<script>
 $(document).ready(function() {
    var pagecount = {$retArr.count};
    var pagesize = {$retArr.page_num};
    var currentpage =  {$retArr.page};
    var showCount =  {$retArr.showCount};

    multi(pagecount,pagesize,currentpage,showCount,"admin","showUserInfo");
    $("#showPage ").val({$retArr.showCount}); //用于显示select的选中事件
});

function isDelete(id){
    if(confirm("确认删除吗？")){
        $.ajax({
            url:'./admin.php?controller=admin&method=delUserInfoByID'
            ,type:"POST"
            ,data:{
                    "id":id
                }
            ,dataType: "json"
            ,success:function(json){
                alert(json.msg);
                location.reload();
            }
            ,error:function(xhr){
                    alert('PHP页面有错误！'+xhr.responseText);
                }
        });
    }else{
        return false;
    }
};
</script>
</body>
</html>